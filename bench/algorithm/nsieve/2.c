// Serial code prime sieve by Daniel Spangberg
// Only count 5760 of 30030 (2*3*5*7*11*13), there are only 5760 numbers not divisible by 2,3,5,7,11,13 within this range
// Discussions and code sharing with @mckoss & @Kinematics
// Converted to be used in Programming Language and compiler Benchmarks by Bela Pecsek
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <time.h>
#include <math.h>

#ifdef COMPILE_64_BIT
#define TYPE uint64_t
#define MASK 0x3FU
#define SHIFT 6U
#else
#define TYPE uint32_t
#define MASK 0x1FU
#define SHIFT 5U
#endif

// Steps array for finding the next number not divisible by 2,3,5,7,11,13
// Pre halved
static unsigned int steps[5760]={
 8,1,2,3,1,3,2,1,2,3,3,1,3,2,1,3,2,3,4,2,1,2,1,2,7,
 2,3,1,5,1,3,3,2,3,3,1,5,1,2,1,6,6,2,1,2,3,1,5,3,3,
 3,1,3,2,1,3,2,7,2,1,2,3,4,3,5,1,2,3,1,3,3,3,2,3,1,
 3,2,4,5,1,5,1,2,1,2,3,4,2,1,2,6,4,2,1,3,2,3,6,1,2,
 1,6,3,2,3,3,3,1,3,5,1,2,3,1,3,3,2,1,5,1,5,1,2,3,3,
 1,3,3,2,3,4,3,2,1,3,2,3,4,2,1,3,2,4,3,2,4,2,3,4,5,
 1,5,1,3,2,1,2,1,5,1,5,1,2,1,2,7,2,1,2,3,3,1,3,2,4,
 5,4,2,1,2,3,4,3,2,3,3,3,1,3,3,2,1,2,3,1,5,1,2,1,5,
 1,5,1,3,2,4,3,2,1,2,3,3,4,2,1,3,5,4,2,1,3,2,4,5,3,
 1,2,4,3,3,2,1,2,3,1,3,2,3,1,5,6,1,2,1,2,3,1,3,2,1,
 2,6,1,3,3,5,3,4,2,1,2,1,2,4,3,6,2,3,1,6,2,1,2,3,4,
 2,1,2,1,6,5,1,2,1,2,3,1,5,1,2,3,4,3,2,1,3,2,3,4,2,
 3,1,2,4,3,2,3,1,2,3,1,3,3,2,3,3,4,3,2,1,5,1,5,1,2,
 1,5,1,3,2,1,5,3,1,3,2,1,3,2,3,4,3,2,1,6,5,3,1,2,3,
 1,6,2,1,2,4,3,2,1,2,1,5,1,5,3,1,2,3,1,3,2,1,5,3,1,
 3,2,6,3,4,3,2,1,2,4,3,2,3,1,2,3,4,3,3,2,3,1,3,2,1,
 2,1,5,6,1,2,6,1,3,2,1,2,3,3,1,6,3,2,9,1,2,1,2,4,3,
 2,3,1,2,4,3,3,2,1,2,3,1,3,2,1,2,6,1,6,3,2,3,1,3,2,
 3,3,3,1,3,2,1,3,2,3,4,2,1,2,1,2,7,2,3,1,5,1,3,3,2,
 1,5,1,5,1,2,7,5,1,2,1,2,3,1,3,5,3,3,1,5,1,3,2,3,4,
 2,1,2,3,4,3,5,1,2,3,1,3,3,2,1,2,3,1,3,2,1,3,5,1,5,
 3,1,2,3,4,2,1,2,6,1,3,2,1,3,2,3,6,1,2,1,2,4,3,2,3,
 1,5,1,3,5,3,3,1,3,2,1,2,1,5,1,6,2,3,3,1,6,2,3,3,1,
 3,2,1,3,2,7,2,1,3,2,4,3,2,3,1,2,3,4,3,3,5,1,3,2,3,
 1,5,1,5,1,2,1,2,4,3,2,1,2,3,3,4,2,4,2,3,4,2,1,2,1,
 6,3,2,3,3,3,1,3,3,2,1,2,3,1,3,3,2,1,5,1,5,1,3,2,3,
 1,3,2,1,2,3,7,2,1,3,5,4,2,1,2,1,2,4,5,4,2,4,3,5,1,
 2,3,1,3,2,3,1,5,1,5,1,2,1,2,3,4,2,1,2,3,3,1,3,3,3,
 5,4,2,1,2,3,4,3,2,4,2,3,1,3,3,2,1,2,3,6,1,2,1,5,1,
 5,1,2,1,2,4,5,1,2,3,4,3,2,1,3,2,3,4,2,4,2,4,3,2,3,
 1,2,3,1,3,3,2,3,3,1,3,3,2,1,5,6,1,2,1,2,3,1,3,2,1,
 8,1,3,2,1,5,3,4,2,1,2,1,6,3,5,1,2,3,1,6,2,1,2,4,3,
 2,1,2,1,6,5,3,1,2,3,1,3,2,1,2,3,3,1,3,2,1,5,3,4,5,
 1,2,4,3,2,3,1,2,3,1,3,3,3,2,3,4,2,1,2,1,5,6,1,2,1,
 5,1,3,2,1,2,3,3,1,5,1,3,2,7,3,2,1,2,4,5,3,1,2,3,1,
 3,3,2,1,2,4,3,2,1,2,6,1,6,2,1,2,3,1,3,2,1,5,3,1,3,
 2,4,2,3,4,2,1,2,1,2,7,2,3,1,5,4,3,2,1,2,3,1,5,1,2,
 1,6,5,1,2,3,3,1,3,2,3,3,3,1,3,3,3,2,3,6,1,2,3,4,3,
 5,1,2,4,3,3,2,1,2,3,1,3,2,1,3,5,1,5,1,3,2,3,4,2,3,
 6,1,3,2,1,3,2,3,6,1,2,1,2,7,2,3,1,2,3,1,3,5,1,5,1,
 3,2,1,2,6,1,5,1,2,3,3,1,3,3,2,3,3,1,5,1,3,2,3,4,2,
 1,3,2,4,3,2,3,1,2,3,4,3,2,1,5,1,3,2,1,3,5,1,5,3,1,
 2,4,3,2,1,2,3,3,1,3,2,4,2,3,4,2,1,2,1,2,4,3,2,3,6,
 1,3,3,2,3,3,1,3,2,1,2,1,5,1,6,3,2,3,1,5,1,2,3,3,4,
 2,1,3,9,2,1,2,1,2,4,5,3,1,2,4,3,3,3,2,3,1,3,2,3,1,
 5,1,5,1,2,1,2,3,1,3,2,1,2,3,3,4,3,3,2,3,4,2,1,2,1,
 6,3,2,6,3,1,3,3,2,1,2,3,4,3,2,1,5,1,5,1,2,1,2,3,1,
 5,1,2,3,4,3,2,1,3,2,3,4,2,3,1,2,4,3,2,4,2,3,1,3,5,
 3,3,1,3,3,2,1,5,1,5,1,2,1,2,3,4,2,1,5,3,1,3,2,1,3,
 5,4,2,1,2,7,3,2,3,1,2,3,1,6,2,1,2,4,5,1,2,1,5,1,5,
 3,1,2,4,3,2,1,2,3,3,1,3,2,1,5,3,4,3,3,2,4,3,2,3,1,
 2,3,1,3,3,3,2,3,1,3,2,1,2,1,5,6,1,2,1,5,1,3,2,1,2,
 6,1,5,1,5,7,2,1,2,1,2,4,3,5,1,2,3,1,6,2,1,2,3,1,3,
 2,1,2,7,6,2,1,2,3,1,3,2,1,2,3,3,1,3,2,1,3,2,3,4,2,
 3,1,2,7,2,3,1,5,1,3,3,2,1,2,3,6,1,2,1,6,5,1,2,1,5,
 1,3,2,3,3,3,1,3,2,1,3,2,3,4,3,2,3,4,8,1,2,3,1,3,3,
 2,1,2,4,3,2,1,3,5,1,5,1,2,1,2,3,4,2,1,8,1,3,2,4,2,
 3,6,1,2,1,2,4,3,2,3,1,2,3,4,5,1,2,3,1,3,2,1,2,1,5,
 1,5,1,2,3,3,1,3,3,2,3,3,1,3,3,3,2,3,6,1,3,2,4,3,2,
 3,1,2,7,3,2,1,5,1,3,2,1,2,1,5,1,5,1,3,2,4,3,2,3,3,
 3,1,3,2,4,2,3,4,2,1,2,1,2,7,2,3,3,3,1,3,3,2,1,5,1,
 3,2,1,2,6,1,5,1,3,2,3,1,3,3,2,3,3,6,1,3,5,4,2,1,2,
 1,2,4,5,3,1,2,4,3,3,2,1,2,3,1,3,2,4,5,1,5,3,1,2,3,
 1,3,2,1,2,3,3,1,3,3,3,2,3,4,2,1,2,1,2,4,3,2,4,5,1,
 3,3,2,3,3,4,2,1,2,1,5,1,6,2,1,2,3,1,5,1,2,3,4,3,2,
 1,3,2,7,2,3,1,2,4,3,2,3,1,2,3,1,3,3,5,3,1,3,5,1,5,
 1,5,1,2,1,2,3,1,3,2,1,5,3,4,2,1,3,2,3,4,2,1,2,1,6,
 3,2,3,3,3,1,6,2,1,2,4,3,3,2,1,5,1,5,3,1,2,3,1,3,2,
 1,2,3,4,3,2,1,5,3,4,3,2,1,2,4,3,2,4,2,3,1,3,6,2,3,
 1,3,2,1,2,1,5,6,1,2,1,5,4,2,1,2,3,3,1,5,1,3,9,2,1,
 2,3,4,3,2,3,1,2,3,1,3,3,2,1,2,3,1,5,1,2,6,1,6,2,1,
 2,4,3,2,1,2,3,3,1,3,2,1,3,2,3,4,2,1,3,2,7,2,3,1,5,
 1,3,3,2,1,2,3,1,5,1,2,1,11,1,2,1,2,3,1,3,2,3,6,1,3,
 2,1,5,3,4,2,1,2,3,4,3,5,1,2,3,1,6,2,1,2,3,1,3,2,1,
 3,6,5,1,2,1,2,3,4,2,1,2,6,1,3,2,1,3,2,3,6,3,1,2,4,
 3,2,3,1,2,3,1,3,5,1,2,3,4,2,1,2,1,5,1,5,1,2,6,1,3,
 3,2,3,3,1,3,2,1,3,2,3,4,3,3,2,4,5,3,1,2,3,4,3,2,1,
 6,3,2,1,2,1,5,1,5,1,2,1,2,4,3,2,1,5,3,1,3,2,4,2,3,
 4,2,1,2,1,2,4,3,2,3,3,3,4,3,2,1,2,3,1,3,2,1,2,1,5,
 1,5,1,5,3,1,3,2,1,2,3,3,4,3,3,5,6,1,2,1,2,4,5,3,1,
 2,4,3,3,2,1,2,3,1,3,2,3,1,5,1,5,1,3,2,3,1,3,2,3,3,
 3,1,3,3,3,2,3,4,2,1,2,1,2,7,2,4,2,3,1,3,3,2,1,5,4,
 2,1,2,6,1,5,1,2,1,2,3,1,6,2,3,4,5,1,3,2,3,4,2,3,1,
 2,4,3,2,3,1,2,3,1,3,3,2,3,3,1,3,3,3,5,1,5,3,1,2,3,
 1,3,2,1,5,3,1,3,2,1,3,2,3,4,2,1,2,1,6,3,2,3,1,5,1,
 6,2,3,4,3,2,1,2,1,5,1,8,1,2,3,1,5,1,2,3,3,1,3,2,1,
 5,7,3,2,1,2,4,3,2,3,1,2,3,1,3,3,3,2,3,1,3,2,3,1,5,
 6,1,2,1,5,1,3,2,1,2,3,3,6,1,3,2,7,2,1,2,1,6,3,2,3,
 3,3,1,3,3,2,1,2,3,1,3,3,2,6,1,6,2,1,2,3,1,3,2,1,2,
 3,4,3,2,1,3,2,3,4,2,1,2,1,2,7,2,4,5,1,3,5,1,2,3,1,
 5,1,2,1,6,5,1,2,1,2,3,4,2,3,3,3,1,3,2,1,3,5,4,2,1,
 2,3,4,3,5,1,2,3,1,3,3,2,1,2,3,1,5,1,3,5,1,5,1,2,1,
 2,7,2,1,2,6,1,3,2,1,3,2,3,6,1,3,2,4,3,2,3,1,2,3,1,
 3,5,1,2,3,1,3,2,1,2,1,5,6,1,2,3,3,1,3,3,2,6,1,3,2,
 1,5,3,4,2,1,3,2,4,3,5,1,2,3,7,2,1,5,1,3,2,1,2,1,6,
 5,1,2,1,2,4,3,2,1,2,3,3,1,3,2,4,2,3,4,2,3,1,2,4,3,
 2,3,3,3,1,3,3,2,1,2,3,4,2,1,2,1,5,1,5,1,3,5,1,3,2,
 1,2,3,3,4,2,1,3,5,4,3,2,1,2,4,5,3,1,2,4,3,3,2,1,2,
 4,3,2,3,1,5,1,5,1,2,1,2,3,1,3,2,1,5,3,1,3,6,2,3,4,
 2,1,2,1,2,4,3,2,4,2,3,4,3,2,1,2,3,4,2,1,2,1,5,1,5,
 1,2,3,3,1,5,1,2,3,4,3,3,3,2,3,6,3,1,2,4,3,2,3,1,2,
 4,3,3,2,3,3,1,3,3,2,1,5,1,5,1,3,2,3,1,3,2,6,3,1,3,
 2,1,3,2,3,4,2,1,2,1,9,2,3,1,2,3,1,6,2,1,6,3,2,1,2,
 6,1,5,3,1,2,3,1,3,3,2,3,3,1,5,1,5,3,4,3,2,1,2,4,3,
 2,3,1,2,3,1,3,3,3,2,3,1,3,2,1,3,5,6,3,1,5,1,3,2,1,
 2,3,3,1,5,1,3,2,7,2,1,2,1,2,4,3,2,3,1,5,1,3,3,2,3,
 3,1,3,2,1,2,6,1,6,2,1,2,3,1,5,1,2,3,3,1,3,2,1,3,2,
 7,2,1,2,1,2,7,2,3,1,5,1,3,3,3,2,3,1,5,3,1,6,5,1,2,
 1,2,3,1,3,2,3,3,3,4,2,1,3,2,3,4,2,1,2,7,3,5,3,3,1,
 3,3,2,1,2,3,1,3,3,3,5,1,5,1,2,1,2,3,4,2,1,2,7,3,2,
 1,3,2,3,6,1,2,1,2,4,3,2,4,2,3,1,3,5,1,2,3,1,3,2,1,
 2,1,5,1,5,1,2,3,3,4,3,2,3,3,1,3,2,1,3,5,4,2,1,5,4,
 3,2,3,1,2,3,4,3,2,1,5,1,5,1,2,1,5,1,5,1,2,1,2,4,3,
 2,1,2,3,3,1,3,2,4,2,3,4,2,1,3,2,4,3,2,3,3,3,1,3,3,
 2,1,2,3,1,3,2,1,2,1,5,6,1,3,2,3,1,3,2,1,2,6,4,2,1,
 8,4,2,1,2,1,2,4,8,1,2,4,6,2,1,2,3,1,3,2,3,1,6,5,1,
 2,1,2,3,1,3,2,1,2,3,3,1,3,3,3,2,3,4,2,3,1,2,4,3,2,
 4,2,3,1,3,3,2,1,2,3,4,2,1,2,1,5,1,5,1,2,1,5,1,5,1,
 2,3,4,3,2,1,3,2,3,4,5,1,2,4,5,3,1,2,3,1,3,3,2,3,4,
 3,3,2,1,5,1,5,1,2,1,2,3,1,3,2,1,5,3,1,3,2,4,2,3,4,
 2,1,2,1,6,3,2,3,1,2,3,7,2,1,2,4,3,2,1,2,1,5,1,5,3,
 3,3,1,3,2,1,2,3,3,1,3,3,5,3,7,2,1,2,4,3,2,3,1,2,4,
 3,3,3,2,3,1,3,2,1,2,1,5,6,1,3,5,1,3,2,3,3,3,1,5,1,
 3,2,7,2,1,2,1,2,7,2,3,1,2,3,1,3,3,2,1,5,1,3,2,1,2,
 6,1,6,2,1,2,3,1,3,3,2,3,3,1,5,1,3,2,3,4,2,1,2,1,2,
 7,2,3,1,5,1,3,3,2,1,2,3,1,5,1,3,6,5,3,1,2,3,1,3,2,
 3,3,3,1,3,2,1,3,2,3,4,2,1,2,3,4,3,5,1,5,1,3,3,2,3,
 3,1,3,2,1,3,5,1,6,2,1,2,3,6,1,2,6,1,3,2,1,3,2,9,1,
 2,1,2,4,3,2,3,1,2,3,1,3,6,2,3,1,3,2,3,1,5,1,5,1,2,
 3,3,1,3,3,2,3,3,4,2,1,3,2,3,4,2,1,3,6,3,2,3,3,3,4,
 3,2,1,5,1,3,3,2,1,5,1,5,1,2,1,2,4,3,2,1,2,3,4,3,2,
 4,2,3,4,2,1,2,1,2,4,3,2,6,3,1,3,5,1,2,3,1,3,2,1,2,
 1,5,1,5,1,3,2,3,4,2,1,2,3,3,4,2,1,3,5,4,2,1,2,3,4,
 5,3,1,2,4,3,3,2,1,2,3,1,5,3,1,5,1,5,1,2,1,2,4,3,2,
 1,2,3,3,1,3,3,3,2,3,4,2,1,3,2,4,3,2,4,2,3,1,3,3,2,
 1,2,3,4,2,1,2,1,5,6,1,2,1,2,3,1,5,1,2,7,3,2,1,5,3,
 4,2,3,1,2,4,3,5,1,2,3,1,6,2,3,3,1,3,3,2,1,6,5,1,2,
 1,2,3,1,3,2,1,5,3,1,3,2,1,3,2,3,4,2,3,1,6,3,2,3,1,
 2,3,1,6,2,1,2,7,2,1,2,1,5,1,5,3,1,5,1,3,2,1,2,3,3,
 1,3,2,1,5,3,4,3,2,1,2,4,5,3,1,2,3,1,3,3,3,2,4,3,2,
 1,2,1,5,6,1,2,1,5,1,3,2,1,5,3,1,5,4,2,7,2,1,2,1,2,
 4,3,2,3,1,2,3,4,3,2,1,2,3,1,3,2,1,2,6,1,6,2,3,3,1,
 3,2,1,2,3,3,1,3,3,3,2,3,6,1,2,1,2,7,2,3,1,6,3,3,2,
 1,2,3,1,5,1,2,1,6,5,1,3,2,3,1,3,2,3,3,3,1,3,2,1,3,
 2,3,4,2,1,2,3,7,5,1,2,3,1,3,3,2,1,5,1,3,2,1,8,1,5,
 1,2,1,2,3,4,3,2,6,1,5,1,3,2,3,6,1,2,1,2,4,3,2,3,1,
 2,3,1,3,5,1,2,3,1,3,2,1,3,5,1,5,3,3,3,1,3,3,2,3,3,
 1,3,2,1,3,2,3,4,2,1,3,2,4,3,2,3,1,5,4,3,2,6,1,3,2,
 1,2,1,5,1,6,2,1,2,4,5,1,2,3,3,1,3,2,4,2,7,2,1,2,1,
 2,4,3,2,3,3,3,1,3,3,3,2,3,1,3,2,3,1,5,1,5,1,3,2,3,
 1,3,2,1,2,3,3,4,2,1,3,5,4,2,1,2,1,6,5,3,3,4,3,3,2,
 1,2,3,1,3,5,1,5,1,5,1,2,1,2,3,1,3,2,1,2,3,4,3,3,3,
 2,3,4,2,1,2,1,2,4,3,2,4,2,3,1,3,5,1,2,3,4,2,1,2,1,
 5,1,5,1,2,1,2,3,6,1,2,3,4,3,2,1,3,5,4,2,3,3,4,3,2,
 3,1,2,3,1,3,3,2,3,3,1,6,2,1,5,1,5,1,2,1,2,4,3,2,1,
 5,3,1,3,2,1,3,2,3,4,2,1,3,6,3,2,3,1,2,3,1,6,2,1,2,
 4,3,2,1,2,1,5,6,3,1,2,3,1,3,2,1,2,6,1,3,2,1,5,3,4,
 3,2,1,2,4,3,5,1,2,3,1,6,3,2,3,1,3,2,1,2,1,11,1,2,1,
 5,1,3,2,1,2,3,3,1,5,1,3,2,7,2,3,1,2,4,3,2,3,1,2,3,
 1,3,3,2,1,2,3,4,2,1,2,6,1,6,2,1,5,1,3,2,1,2,3,3,1,
 3,2,1,3,2,3,4,3,2,1,2,9,3,1,5,1,3,3,2,1,2,4,5,1,2,
 1,6,5,1,2,1,2,3,1,3,2,6,3,1,3,2,4,2,3,4,2,1,2,3,4,
 3,5,1,2,3,4,3,2,1,2,3,1,3,2,1,3,5,1,5,1,2,3,3,4,2,
 1,2,6,1,3,3,3,2,3,6,1,2,1,2,4,3,2,3,1,2,4,3,5,1,2,
 3,1,3,2,1,2,1,5,1,5,1,5,3,1,3,5,3,3,1,3,2,1,3,2,3,
 4,2,1,3,2,7,2,3,1,2,3,4,3,2,1,5,1,3,2,1,2,6,1,5,1,
 2,1,2,4,3,3,2,3,3,1,5,4,2,3,4,2,1,2,1,2,4,3,2,3,3,
 3,1,3,3,2,1,2,3,1,3,2,1,3,5,1,5,4,2,3,1,3,2,1,2,3,
 3,4,2,1,3,5,4,2,1,2,1,2,4,5,3,1,6,3,3,2,3,3,1,3,2,
 3,1,5,1,6,2,1,2,3,1,5,1,2,3,3,1,3,3,3,2,7,2,1,2,1,
 2,4,3,2,4,2,3,1,3,3,3,2,3,4,2,3,1,5,1,5,1,2,1,2,3,
 1,5,1,2,3,7,2,1,3,2,3,4,2,3,1,6,3,2,3,3,3,1,3,3,2,
 3,3,1,3,3,2,1,5,1,5,1,2,1,2,3,1,3,2,1,5,4,3,2,1,3,
 2,3,4,2,1,2,1,6,3,2,4,2,3,1,8,1,2,4,3,2,1,2,1,5,1,
 5,3,1,2,3,4,2,1,2,3,3,1,3,2,1,8,4,3,2,3,4,3,2,3,1,
 2,3,1,3,3,3,2,3,1,5,1,2,1,5,6,1,2,1,6,3,2,1,2,3,3,
 1,5,1,3,2,7,2,1,3,2,4,3,2,3,1,2,3,1,3,3,2,1,2,3,1,
 3,2,1,2,6,7,2,1,2,3,1,3,2,1,2,6,1,3,2,1,5,3,4,2,1,
 2,1,2,7,5,1,5,1,6,2,1,2,3,1,5,1,2,1,6,5,1,2,1,2,3,
 1,3,2,3,3,3,1,3,2,1,3,2,3,4,2,3,3,4,3,5,1,2,3,1,3,
 3,2,1,2,3,4,2,1,3,5,1,5,1,2,1,5,4,2,1,2,6,1,3,2,1,
 3,2,3,7,2,1,2,4,5,3,1,2,3,1,3,5,1,2,4,3,2,1,2,1,5,
 1,5,1,2,3,3,1,3,3,5,3,1,3,2,4,2,3,4,2,1,3,2,4,3,2,
 3,1,2,3,4,3,2,1,5,1,3,2,1,2,1,5,1,5,1,2,3,4,3,2,1,
 2,3,3,1,3,6,2,3,6,1,2,1,2,4,3,2,3,3,4,3,3,2,1,2,3,
 1,3,2,1,2,1,5,1,5,1,3,2,3,1,3,2,3,3,3,4,2,1,3,5,4,
 2,1,2,1,2,9,3,1,2,4,3,3,2,1,5,1,3,2,3,6,1,5,1,2,1,
 2,3,1,3,3,2,3,3,1,6,3,2,3,4,2,1,2,1,2,4,3,2,4,2,3,
 1,3,3,2,1,2,3,4,2,1,3,5,1,5,3,1,2,3,1,5,1,2,3,4,3,
 2,1,3,2,3,4,2,3,1,2,4,3,2,3,1,5,1,3,3,2,3,3,1,3,3,
 2,1,5,1,6,2,1,2,3,1,5,1,5,3,1,3,2,1,3,2,7,2,1,2,1,
 6,3,2,3,1,2,3,1,6,3,2,4,3,2,3,1,5,1,5,3,1,2,3,1,3,
 2,1,2,3,3,4,2,1,5,3,4,3,2,1,6,3,2,3,3,3,1,3,3,3,2,
 3,1,3,3,2,1,5,6,1,2,1,5,1,3,2,1,2,3,4,5,1,3,2,7,2,
 1,2,1,2,4,3,2,4,2,3,1,3,5,1,2,3,1,3,2,1,2,6,1,6,2,
 1,2,3,4,2,1,2,3,3,1,3,2,1,3,5,4,2,1,2,3,7,2,3,1,5,
 1,3,3,2,1,2,3,1,5,1,2,1,6,5,1,2,1,2,4,3,2,3,3,3,1,
 3,2,1,3,2,3,4,2,1,5,4,3,5,1,2,3,1,3,3,2,1,2,3,1,3,
 2,1,3,5,6,1,2,1,2,3,4,2,1,2,6,1,3,2,1,5,3,6,1,2,1,
 2,4,3,5,1,2,3,1,8,1,2,3,1,3,2,1,2,1,6,5,1,2,3,3,1,
 3,3,2,3,3,1,3,2,1,3,2,3,4,2,4,2,4,3,2,3,1,2,3,4,3,
 2,1,5,4,2,1,2,1,5,1,5,1,2,1,6,3,2,1,2,3,3,1,3,2,4,
 2,3,4,3,2,1,2,4,5,3,3,3,1,3,3,2,1,2,4,3,2,1,2,1,5,
 1,5,1,3,2,3,1,3,2,1,5,3,4,2,4,5,4,2,1,2,1,2,4,5,3,
 1,2,7,3,2,1,2,3,1,3,2,3,1,5,1,5,1,2,3,3,1,3,2,1,2,
 3,3,1,3,3,3,2,3,6,1,2,1,2,4,3,2,4,2,4,3,3,2,1,2,3,
 4,2,1,2,1,5,1,5,1,3,2,3,1,5,3,3,4,3,2,1,3,2,3,4,2,
 3,1,2,7,2,3,1,2,3,1,3,3,2,6,1,3,3,2,6,1,5,1,2,1,2,
 3,1,3,3,5,3,1,5,1,3,2,3,4,2,1,2,1,6,3,2,3,1,2,3,1,
 6,2,1,2,4,3,2,1,3,5,1,5,3,1,2,3,1,3,2,1,2,3,3,1,3,
 2,1,5,3,4,3,2,1,2,4,3,2,3,1,5,1,3,3,5,3,1,3,2,1,2,
 1,5,7,2,1,5,1,5,1,2,3,3,1,5,1,3,2,7,2,1,2,1,2,4,3,
 2,3,1,2,3,1,3,3,3,2,3,1,3,2,3,6,1,6,2,1,2,3,1,3,2,
 1,2,3,3,4,2,1,3,2,3,4,2,1,2,1,9,2,3,6,1,3,3,2,1,2,
 3,1,6,2,1,6,5,1,2,1,2,3,1,3,2,3,3,4,3,2,1,3,2,3,4,
 2,1,2,3,4,3,6,2,3,1,3,5,1,2,3,1,3,2,1,3,5,1,5,1,2,
 1,2,3,4,2,1,2,6,1,3,2,1,3,5,6,1,2,3,4,3,2,3,1,2,3,
 1,3,5,1,2,3,1,5,1,2,1,5,1,5,1,2,3,4,3,3,2,3,3,1,3,
 2,1,3,2,3,4,2,1,3,2,4,3,2,3,1,2,3,4,3,2,1,5,1,3,2,
 1,2,1,5,6,1,2,1,2,4,3,2,1,2,6,1,3,2,6,3,4,2,1,2,1,
 2,4,3,5,3,3,1,6,2,1,2,3,1,3,2,1,2,1,6,5,1,3,2,3,1,
 3,2,1,2,3,3,4,2,1,3,5,4,2,3,1,2,4,5,3,1,2,4,3,3,2,
 1,2,3,4,2,3,1,5,1,5,1,2,1,5,1,3,2,1,2,3,3,1,3,3,3,
 2,3,4,3,2,1,2,4,5,4,2,3,1,3,3,2,1,2,7,2,1,2,1,5,1,
 5,1,2,1,2,3,1,5,1,5,4,3,2,4,2,3,4,2,3,1,2,4,3,2,3,
 1,2,3,4,3,2,3,3,1,3,3,2,1,5,1,5,1,2,3,3,1,3,2,1,5,
 3,1,3,3,3,2,3,6,1,2,1,6,3,2,3,1,2,4,6,2,1,2,4,3,2,
 1,2,1,5,1,5,4,2,3,1,3,2,3,3,3,1,3,2,1,5,3,4,3,2,1,
 2,7,2,3,1,2,3,1,3,3,3,5,1,3,2,1,2,6,6,1,2,1,5,1,3,
 3,2,3,3,1,5,1,3,2,7,2,1,2,1,2,4,3,2,3,1,2,3,1,3,3,
 2,1,2,3,1,3,2,1,8,1
};

struct sieve_state {
  TYPE *a;
  unsigned int maxints;
};

struct sieve_state *create_sieve(int maxints) {
  struct sieve_state *sieve_state=malloc(sizeof *sieve_state);
  // We need to store only odd integers, so only half the number of integers
  sieve_state->a=calloc((maxints + 16*sizeof(TYPE) - 1) / 16 / sizeof(TYPE), sizeof(TYPE));
  sieve_state->maxints=maxints;
  return sieve_state;
}

void delete_sieve(struct sieve_state *sieve_state) {
  free(sieve_state->a);
  free(sieve_state);
}

void run_sieve(struct sieve_state *sieve_state) {
  unsigned int maxints=sieve_state->maxints;
  unsigned int maxintsh=maxints>>1U;
  TYPE *a=sieve_state->a;
  unsigned int q=(unsigned int)sqrt(maxints)+1U;
  unsigned int step=1U; // From 17 to 19
  unsigned int inc=steps[step]; // Next increment in steps array
  // Only check integers not divisible by 2, 3, 5, 7, 11, or 13
  unsigned int factorh=17U>>1U; // We already have 2, 3, 5, 7, 11, and 13
  unsigned int qh=q>>1U;
  while (factorh<=qh) {
    // Search for next prime
    if (a[factorh>>SHIFT]&((TYPE)1<<(factorh&MASK))) {
      factorh+=inc;
      if (++step==5760U) step=0U; // End of steps array, start from the beginning
      inc=steps[step];
      continue;
    }
    // Mask all integer multiples of this prime, but only the bits we will ever read again
    unsigned int istep=step;
    unsigned int ninc=steps[istep];
    unsigned int factor=(factorh<<1U)+1U;
    for (unsigned int i=(factor*factor)>>1U; i<maxintsh; ) {
      a[i>>SHIFT]|=(TYPE)1<<(i&MASK);
      i+=factor*ninc;
      if (++istep==5760U) istep=0U;
      ninc=steps[istep];
    }
    factorh+=inc;
    if (++step==5760U) step=0U; // End of steps array, start from the beginning
    inc=steps[step];
  }
}

void count_primes(struct sieve_state *sieve_state) {
  unsigned int maxints=sieve_state->maxints;
  TYPE *a=sieve_state->a;
  unsigned int ncount=6; // We already have 2, 3, 5, 7, 11, and 13 ...
  unsigned int factor=17; // ...
  unsigned int step=1; // From 17 to 19
  unsigned int inc=steps[step]<<1U; // Next increment in steps array
  while (factor<=maxints) {
    if (!(a[factor>>(SHIFT+1U)]&((TYPE)1<<((factor>>1U)&MASK))))
      ncount++;
    factor+=inc;
    if (++step==5760U) step=0U; // End of steps array, start from the beginning
    inc=steps[step]<<1U;
  }
  printf("Primes up to %8u %8u\n", maxints, ncount);
}

int main(int argc, char **argv) {
  int m = atoi(argv[1]);
  struct sieve_state *sieve_state;
  for (int i = 0; i < 3; i++) {
    sieve_state=create_sieve(10000 << (m - i));
    run_sieve(sieve_state);
    count_primes(sieve_state);
    delete_sieve(sieve_state);
  }
  return 0;
}
